\hypertarget{addrman_8h}{}\section{/\+Users/christopherarguello/\+Developer/anon/src/addrman.h File Reference}
\label{addrman_8h}\index{/\+Users/christopherarguello/\+Developer/anon/src/addrman.\+h@{/\+Users/christopherarguello/\+Developer/anon/src/addrman.\+h}}
{\ttfamily \#include \char`\"{}netbase.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}protocol.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}random.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sync.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}timedata.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}util.\+h\char`\"{}}\newline
{\ttfamily \#include $<$map$>$}\newline
{\ttfamily \#include $<$set$>$}\newline
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{class_c_addr_info}{C\+Addr\+Info}}
\item 
class \mbox{\hyperlink{class_c_addr_man}{C\+Addr\+Man}}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{addrman_8h_ab09df186aa818ce7b9e7c86446511cf1}{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT}}~256
\begin{DoxyCompactList}\small\item\em total number of buckets for tried addresses \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_a74a626eb1dbb8e307a413e86493cd510}{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT}}~1024
\begin{DoxyCompactList}\small\item\em total number of buckets for new addresses \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_a3499731a6c89e164cf74b68be2be0a84}{A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+ZE}}~64
\begin{DoxyCompactList}\small\item\em maximum allowed number of entries in buckets for new and tried addresses \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_a87c7c90e3631bf1a4475cabdded61f6f}{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+UP}}~8
\begin{DoxyCompactList}\small\item\em over how many buckets entries with tried addresses from a single group (/16 for I\+Pv4) are spread \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_a09c090218fd02375aa57eb7e8eb1c013}{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+UP}}~64
\begin{DoxyCompactList}\small\item\em over how many buckets entries with new addresses originating from a single group are spread \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_a230e30813119d10bdba59c1f8cc789cd}{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+SS}}~8
\begin{DoxyCompactList}\small\item\em in how many buckets for entries with new addresses a single address may occur \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_a86698b159625d84b47a2ffddc76ebc99}{A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+YS}}~30
\begin{DoxyCompactList}\small\item\em how old addresses can maximally be \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_a771c05a7a20d9a35f4546e1e333c48c4}{A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+ES}}~3
\begin{DoxyCompactList}\small\item\em after how many failed attempts we give up on a new node \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_a26430e6e9a3ef9f4fc54491330b7e611}{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+ES}}~10
\begin{DoxyCompactList}\small\item\em how many successive failures are allowed ... \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_a7dcc28590c48ca382d26c4f37fda4e3d}{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+YS}}~7
\begin{DoxyCompactList}\small\item\em ... in at least this many days \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_a06edfd03ad361fbc74794e1c533d1bc5}{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+CT}}~23
\begin{DoxyCompactList}\small\item\em the maximum percentage of nodes to return in a getaddr call \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{addrman_8h_ad10877f29a66224fce5c20d33e26448a}{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+AX}}~2500
\begin{DoxyCompactList}\small\item\em the maximum number of nodes to return in a getaddr call \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{addrman_8h_a3499731a6c89e164cf74b68be2be0a84}\label{addrman_8h_a3499731a6c89e164cf74b68be2be0a84}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+ZE@{A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+ZE}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+ZE@{A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+ZE}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+ZE}{ADDRMAN\_BUCKET\_SIZE}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+S\+I\+ZE~64}



maximum allowed number of entries in buckets for new and tried addresses 

\mbox{\Hypertarget{addrman_8h_ad10877f29a66224fce5c20d33e26448a}\label{addrman_8h_ad10877f29a66224fce5c20d33e26448a}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+AX@{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+AX}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+AX@{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+AX}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+AX}{ADDRMAN\_GETADDR\_MAX}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+AX~2500}



the maximum number of nodes to return in a getaddr call 

\mbox{\Hypertarget{addrman_8h_a06edfd03ad361fbc74794e1c533d1bc5}\label{addrman_8h_a06edfd03ad361fbc74794e1c533d1bc5}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+CT@{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+CT}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+CT@{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+CT}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+CT}{ADDRMAN\_GETADDR\_MAX\_PCT}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+G\+E\+T\+A\+D\+D\+R\+\_\+\+M\+A\+X\+\_\+\+P\+CT~23}



the maximum percentage of nodes to return in a getaddr call 

\mbox{\Hypertarget{addrman_8h_a86698b159625d84b47a2ffddc76ebc99}\label{addrman_8h_a86698b159625d84b47a2ffddc76ebc99}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+YS@{A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+YS}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+YS@{A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+YS}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+YS}{ADDRMAN\_HORIZON\_DAYS}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+H\+O\+R\+I\+Z\+O\+N\+\_\+\+D\+A\+YS~30}



how old addresses can maximally be 

\mbox{\Hypertarget{addrman_8h_a26430e6e9a3ef9f4fc54491330b7e611}\label{addrman_8h_a26430e6e9a3ef9f4fc54491330b7e611}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+ES@{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+ES}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+ES@{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+ES}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+ES}{ADDRMAN\_MAX\_FAILURES}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+A\+X\+\_\+\+F\+A\+I\+L\+U\+R\+ES~10}



how many successive failures are allowed ... 

\mbox{\Hypertarget{addrman_8h_a7dcc28590c48ca382d26c4f37fda4e3d}\label{addrman_8h_a7dcc28590c48ca382d26c4f37fda4e3d}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+YS@{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+YS}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+YS@{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+YS}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+YS}{ADDRMAN\_MIN\_FAIL\_DAYS}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+M\+I\+N\+\_\+\+F\+A\+I\+L\+\_\+\+D\+A\+YS~7}



... in at least this many days 

\mbox{\Hypertarget{addrman_8h_a74a626eb1dbb8e307a413e86493cd510}\label{addrman_8h_a74a626eb1dbb8e307a413e86493cd510}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT}{ADDRMAN\_NEW\_BUCKET\_COUNT}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT~1024}



total number of buckets for new addresses 

\mbox{\Hypertarget{addrman_8h_a230e30813119d10bdba59c1f8cc789cd}\label{addrman_8h_a230e30813119d10bdba59c1f8cc789cd}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+SS@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+SS}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+SS@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+SS}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+SS}{ADDRMAN\_NEW\_BUCKETS\_PER\_ADDRESS}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+A\+D\+D\+R\+E\+SS~8}



in how many buckets for entries with new addresses a single address may occur 

\mbox{\Hypertarget{addrman_8h_a09c090218fd02375aa57eb7e8eb1c013}\label{addrman_8h_a09c090218fd02375aa57eb7e8eb1c013}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+UP@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+UP}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+UP@{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+UP}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+UP}{ADDRMAN\_NEW\_BUCKETS\_PER\_SOURCE\_GROUP}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+N\+E\+W\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+G\+R\+O\+UP~64}



over how many buckets entries with new addresses originating from a single group are spread 

\mbox{\Hypertarget{addrman_8h_a771c05a7a20d9a35f4546e1e333c48c4}\label{addrman_8h_a771c05a7a20d9a35f4546e1e333c48c4}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+ES@{A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+ES}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+ES@{A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+ES}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+ES}{ADDRMAN\_RETRIES}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+R\+E\+T\+R\+I\+ES~3}



after how many failed attempts we give up on a new node 

\mbox{\Hypertarget{addrman_8h_ab09df186aa818ce7b9e7c86446511cf1}\label{addrman_8h_ab09df186aa818ce7b9e7c86446511cf1}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT@{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT@{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT}{ADDRMAN\_TRIED\_BUCKET\_COUNT}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+C\+O\+U\+NT~256}



total number of buckets for tried addresses 

Stochastic address manager

Design goals\+:
\begin{DoxyItemize}
\item Keep the address tables in-\/memory, and asynchronously dump the entire table to peers.\+dat.
\item Make sure no (localized) attacker can fill the entire table with his nodes/addresses.
\end{DoxyItemize}

To that end\+:
\begin{DoxyItemize}
\item Addresses are organized into buckets.
\begin{DoxyItemize}
\item Addresses that have not yet been tried go into 1024 \char`\"{}new\char`\"{} buckets.
\begin{DoxyItemize}
\item Based on the address range (/16 for I\+Pv4) of the source of information, 64 buckets are selected at random.
\item The actual bucket is chosen from one of these, based on the range in which the address itself is located.
\item One single address can occur in up to 8 different buckets to increase selection chances for addresses that are seen frequently. The chance for increasing this multiplicity decreases exponentially.
\item When adding a new address to a full bucket, a randomly chosen entry (with a bias favoring less recently seen ones) is removed from it first.
\end{DoxyItemize}
\item Addresses of nodes that are known to be accessible go into 256 \char`\"{}tried\char`\"{} buckets.
\begin{DoxyItemize}
\item Each address range selects at random 8 of these buckets.
\item The actual bucket is chosen from one of these, based on the full address.
\item When adding a new good address to a full bucket, a randomly chosen entry (with a bias favoring less recently tried ones) is evicted from it, back to the \char`\"{}new\char`\"{} buckets.
\end{DoxyItemize}
\item Bucket selection is based on cryptographic hashing, using a randomly-\/generated 256-\/bit key, which should not be observable by adversaries.
\item Several indexes are kept for high performance. Defining D\+E\+B\+U\+G\+\_\+\+A\+D\+D\+R\+M\+AN will introduce frequent (and expensive) consistency checks for the entire data structure. 
\end{DoxyItemize}
\end{DoxyItemize}\mbox{\Hypertarget{addrman_8h_a87c7c90e3631bf1a4475cabdded61f6f}\label{addrman_8h_a87c7c90e3631bf1a4475cabdded61f6f}} 
\index{addrman.\+h@{addrman.\+h}!A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+UP@{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+UP}}
\index{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+UP@{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+UP}!addrman.\+h@{addrman.\+h}}
\subsubsection{\texorpdfstring{A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+UP}{ADDRMAN\_TRIED\_BUCKETS\_PER\_GROUP}}
{\footnotesize\ttfamily \#define A\+D\+D\+R\+M\+A\+N\+\_\+\+T\+R\+I\+E\+D\+\_\+\+B\+U\+C\+K\+E\+T\+S\+\_\+\+P\+E\+R\+\_\+\+G\+R\+O\+UP~8}



over how many buckets entries with tried addresses from a single group (/16 for I\+Pv4) are spread 

